(function(t){function e(e){for(var i,r,l=e[0],o=e[1],d=e[2],h=0,u=[];h<l.length;h++)r=l[h],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&u.push(s[r][0]),s[r]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);c&&c(e);while(u.length)u.shift()();return n.push.apply(n,d||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,l=1;l<a.length;l++){var o=a[l];0!==s[o]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},s={app:0},n=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/water-level-rdl-app/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var c=o;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";a("85ec")},"0780":function(t,e,a){t.exports=a.p+"img/calendar-icon.9317a9f4.svg"},"1b63":function(t,e,a){t.exports=a.p+"img/marina_rdl.c68534f9.png"},"1c91":function(t,e,a){},"1e80":function(t,e,a){"use strict";a("236d")},"236d":function(t,e,a){},"49f8":function(t,e,a){var i={"./en.json":"edd4","./fr.json":"f693"};function s(t){var e=n(t);return a(e)}function n(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=n,t.exports=s,s.id="49f8"},"56d7":function(t,e,a){"use strict";a.r(e);var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"app-header"},[a("div",{staticClass:"app-title"},[t._v(t._s(t.$t("app-title")))]),a("TheLanguageButton")],1),a("div",{staticClass:"the-app-core"},[a("div",{staticClass:"controlAndChart"},[a("TheControlPane",{staticClass:"controlPanel",on:{config:t.modifyData,waterLevelType:t.changeType}}),a("TheChartAndOptions",{staticClass:"the-results",attrs:{dataToDisplay:t.dataToDisplay,range:t.range}})],1)]),a("div",{staticClass:"app-footer"})])},n=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"typeOfUserSelection"},[i("div",{staticClass:"typeOfUserButton",class:"member"===t.activeTab?"activeUserTab":"",on:{click:function(e){t.activeTab="member"}}},[t._v(" "+t._s(t.$t("member")))]),i("div",{staticClass:"typeOfUserButton",class:"visitor"===t.activeTab?"activeUserTab":"",on:{click:function(e){t.activeTab="visitor"}}},[t._v(t._s(t.$t("visitor")))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"member"===t.activeTab,expression:"activeTab === 'member'"}],staticClass:"control-pane-tab"},[i("div",{staticClass:"dates-chosen-and-calendar"},[i("img",{staticClass:"calendar-popup",attrs:{id:"calendar-popup-member",src:a("0780")}})]),i("b-popover",{attrs:{target:"calendar-popup-member",title:t.$t("calendar"),triggers:"hover focus"}},[i("div",{staticClass:"date-selector"},[i("v-date-picker",{attrs:{"is-range":""},on:{input:function(e){return t.handleInput()}},model:{value:t.range,callback:function(e){t.range=e},expression:"range"}})],1),i("div",[t._v(t._s(t.$t("calendar-explanation")))]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.invalidRange,expression:"invalidRange"}],staticClass:"warning-range"},[t._v(" "+t._s(t.$t("invalidRangeMessage"))+" ")])]),i("div",{staticClass:"input-selector"},[i("div",{staticClass:"input-selector-specific-wl-text"},[t._v(t._s(t.$t("specific-water-level")))]),i("div",{staticClass:"input-selector-specific-wl"},[i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.specificWaterLevel,expression:"specificWaterLevel",modifiers:{number:!0}}],staticClass:"draught-selector-input",attrs:{type:"number"},domProps:{value:t.specificWaterLevel},on:{input:[function(e){e.target.composing||(t.specificWaterLevel=t._n(e.target.value))},t.emitConfig],blur:function(e){return t.$forceUpdate()}}}),i("UnitsSelector",{staticClass:"draught-selector-children"})],1)])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"visitor"===t.activeTab,expression:"activeTab === 'visitor'"}],staticClass:"control-pane-tab"},[i("div",{staticClass:"dates-chosen-and-calendar"},[i("img",{staticClass:"calendar-popup",attrs:{id:"calendar-popup-visitor",src:a("0780")}})]),i("b-popover",{attrs:{target:"calendar-popup-visitor",title:t.$t("calendar"),triggers:"hover focus"}},[i("div",{staticClass:"date-selector"},[i("v-date-picker",{attrs:{"is-range":""},on:{input:function(e){return t.handleInput()}},model:{value:t.range,callback:function(e){t.range=e},expression:"range"}})],1),i("div",[t._v(t._s(t.$t("calendar-explanation")))]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.invalidRange,expression:"invalidRange"}],staticClass:"warning-range"},[t._v(" "+t._s(t.$t("invalidRangeMessage"))+" ")])]),i("div",{staticClass:"draught-selector"},[i("div",{staticClass:"draught-selector-children"},[i("div",[t._v(" "+t._s(t.$t("draught"))+" ")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.draught,expression:"draught",modifiers:{number:!0}}],staticClass:"draught-selector-input",attrs:{type:"number"},domProps:{value:t.draught},on:{input:[function(e){e.target.composing||(t.draught=t._n(e.target.value))},t.emitConfig],blur:function(e){return t.$forceUpdate()}}})]),i("UnitsSelector",{staticClass:"draught-selector-children"})],1),i("div",{staticClass:"destination-selector"},[i("div",[i("div",{staticClass:"destination-selector-children",class:t.destinationSelected===t.marinaValue?"active-selection":"",on:{click:function(){t.destinationSelected=t.marinaValue,t.emitConfig()}}},[t._v(" Marina")]),i("div",{staticClass:"destination-selector-children",class:t.destinationSelected===t.visitorValue?"active-selection":"",on:{click:function(){t.destinationSelected=t.visitorValue,t.emitConfig()}}},[t._v(t._s(t.$t("visitor-dock")))])]),i("div",{staticClass:"marina-layout-option",on:{click:function(e){t.extandMarina=!t.extandMarina}}},[i("div",[t._v(t._s(t.$t("marina-layout")))]),i("img",{attrs:{id:"marina-image-small",src:a("1b63")}})])]),t.extandMarina?i("img",{attrs:{id:"marina-image",src:a("1b63")},on:{click:function(e){t.extandMarina=!1}}}):t._e()],1)])},l=[];const o={foot:{fr:"ft",en:"ft"},meter:{fr:"m",en:"m"}};let d={meter:function(t){return Math.round(.3048*t*100)/100},foot:function(t){return Math.round(t/.3048*100)/100}};const c={fr:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},h={fr:["Jan","Fev","Mar","Avr","Mai","Juin","Juil","Aout","Sep","Oct","Nov","Dec"],en:["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct","Nov","Dec"]},u={dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},p={dateTime:"%a %e %b %Y %X",date:"%Y-%m-%d",time:"%H:%M:%S",periods:["",""],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim","lun","mar","mer","jeu","ven","sam"],months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortMonths:["jan","fév","mar","avr","mai","jui","jul","aoû","sep","oct","nov","déc"]};function v(t,e){var a=e[t.getDay()];let i=""+(t.getMonth()+1),s=""+t.getDate();t.getFullYear();i.length<2&&(i="0"+i),s.length<2&&(s="0"+s);var n=[i,s].join("-");return[a,n].join(" ")}function f(t){var e=t.getHours(),a=t.getMinutes();return a<10&&(a="0"+String(a)),[e,a].join(":")}var g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"unit-selector"},[a("div",[a("div",{staticClass:"unit-selector-children",class:"meter"===t.displayUnitsSelected?"active-selection":"",on:{click:function(){t.displayUnitsSelected="meter"}}},[t._v(t._s(t.$t("meters")))]),a("div",{staticClass:"unit-selector-children",class:"foot"===t.displayUnitsSelected?"active-selection":"",on:{click:function(){t.displayUnitsSelected="foot"}}},[t._v(t._s(t.$t("feet")))])])])},m=[],y={data(){return{displayUnitsSelected:this.$store.state.units}},watch:{displayUnitsSelected:function(t){this.$store.mutations.updateSelectedUnits(t)},"$store.state.units":function(t){this.displayUnitsSelected=t}}},x=y,D=(a("bc82"),a("2877")),w=Object(D["a"])(x,g,m,!1,null,null,null),b=w.exports,C={components:{UnitsSelector:b},computed:{datesDisplayed(){let t=v(this.range.start,c[this.$i18n.locale]),e=v(this.range.end,c[this.$i18n.locale]);return t===e?t:`${t} - ${e}`},validRange(){return!(this.calculateDiffDays(this.range.start,this.range.end)>6)},visitorValue(){return this.visitorValues[this.$store.state.units]},marinaValue(){return this.marinaValues[this.$store.state.units]}},data(){let t=1.1,e=2.1,a={meter:t,foot:d.foot(t)},i={meter:e,foot:d.foot(e)};return{extandMarina:!1,activeTab:"member",tabIndex:0,invalidRange:!1,specificWaterLevel:2,draught:0,range:{start:new Date,end:new Date},trimmedRange:{start:null,end:null},marinaValues:i,visitorValues:a,destinationSelected:i[this.$store.state.units]}},methods:{calculateDiffDays:function(t,e){const a=864e5;return Math.round(Math.abs((t-e)/a))},emitConfig:function(){let t={};t["draught"]=this.draught,t["range"]=this.trimmedRange,t["destination"]=parseFloat(this.destinationSelected),t["specificWaterLevel"]=""===this.specificWaterLevel?0:this.specificWaterLevel,this.$emit("config",t)},handleInput(){this.$nextTick(()=>{let t;this.validRange?(this.range={start:this.range.start,end:this.range.end},t=new Date(this.range.end),this.invalidRange=!1):(t=new Date,t.setMonth(this.range.start.getMonth()),t.setDate(this.range.start.getDate()+5),this.range={start:this.range.start,end:new Date(t)},this.invalidRange=!0),this.range.start.setHours(0,0,0,0),t.setDate(t.getDate()+1),t.setHours(0,0,0,0),this.trimmedRange={start:this.range.start,end:t}})}},mounted(){let t=this;async function e(){await t.handleInput()}e()},watch:{trimmedRange:function(){this.emitConfig()},activeTab:function(){this.$emit("waterLevelType",this.activeTab)},"$store.state.units":function(t){this.draught=d[t](this.draught),this.specificWaterLevel=d[t](this.specificWaterLevel),this.destinationSelected=d[t](this.destinationSelected),this.emitConfig()}}},M=C,T=(a("b5ec"),Object(D["a"])(M,r,l,!1,null,null,null)),k=T.exports,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"chartAndOptions"},[i("TheChart",{staticClass:"svg-container",attrs:{id:"waterLevelChart",dataToDisplay:t.dataToDisplay,range:t.range,bus:t.bus},on:{colorBoxChanged:t.loadColorBoxes,draggedDate:t.setActiveDot}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.daysArray.length>1,expression:"daysArray.length > 1"}],staticClass:"dot-wrapper"},[i("div",{class:{greyed:t.isBackGreyed},on:{click:t.dayMinusOne}},[i("img",{staticClass:"back-next-arrows",attrs:{src:t.isBackGreyed?a("60dc"):t.isBackHovered?a("5d23"):a("85a8")},on:{mouseover:t.mouseOverBack,mouseleave:t.mouseLeaveBack}})]),t._l(t.daysArray.length,(function(e){return i("div",{key:e,staticClass:"dot-date",on:{click:function(a){return t.logClick(e)}}},[i("div",{staticClass:"dot",class:{active:t.activeIndex===e}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.activeIndex===e,expression:"activeIndex === index"}],staticClass:"active-date"},[i("div",{staticClass:"active-date-line"},[t._v(t._s(t.getDay(t.daysArray[e-1])))]),i("div",{staticClass:"active-date-line"},[t._v(t._s(t.getDate(t.daysArray[e-1])))])])])})),i("div",{class:{greyed:t.isNextGreyed},on:{click:t.dayPlusOne}},[i("img",{staticClass:"back-next-arrows",attrs:{src:t.isNextGreyed?a("f18b"):t.isNextHovered?a("ab43"):a("6882")},on:{mouseover:t.mouseOverNext,mouseleave:t.mouseLeaveNext}})])],2)],1),i("div",{staticClass:"separator"}),i("div",{staticClass:"calendar-section"},[i("TheCalendarView",{attrs:{colorBoxes:t.colorBoxes,range:t.range}})],1)])},_=[],S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"calendar-days"},t._l(t.days,(function(e){return a("div",{key:e.title},[a("div",{staticClass:"calendar-day"},[a("div",{staticClass:"calendar-day-title"},[t._v(t._s(e.title))]),t._l(e.data,(function(e){return a("div",{key:e},[t._v(t._s(e))])}))],2)])})),0)])},$=[],I={props:["colorBoxes","range"],computed:{days(){let t=this.getDates(new Date(this.range[0]),new Date(this.range[1])),e=[];for(let a of t)e.push({title:v(a,c[this.$i18n.locale]),data:[]});for(let a=0;a<this.colorBoxes.length;a++){let t=!1;if("good"===this.colorBoxes[a].type){let i,s=v(this.colorBoxes[a].startDate,c[this.$i18n.locale]),n=v(this.colorBoxes[a].endDate,c[this.$i18n.locale]);s===n?i=`${f(this.colorBoxes[a].startDate)} - ${f(this.colorBoxes[a].endDate)}`:(t=!0,i=f(this.colorBoxes[a].startDate)+" - 23:59");let r=e.findIndex(t=>t.title===s);void 0!=e[r]&&s===e[r].title&&e[r].data.push(i),t&&(i="00:00 - "+f(this.colorBoxes[a].endDate),"00:00 - 0:00"!=i&&(r=e.findIndex(t=>t.title===n),void 0!=e[r]&&n===e[r].title&&e[r].data.push(i)))}}return e}},methods:{getDates(t,e){var a=[],i=t;while(i<e)a.push(new Date(i)),i.setDate(i.getDate()+1);return a}}},B=I,A=(a("1e80"),Object(D["a"])(B,S,$,!1,null,null,null)),O=A.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},R=[],V=(a("13d5"),a("898b")),N=(a("3c43"),{props:["dataToDisplay","range","bus"],data(){var t=this,e=V["d"]().x((function(e){return t.x(e.date)})).y((function(e){return t.y(e.value)}));return{fontFamily:"Noto-Sans-JP, Avenir, Helvetica, Arial, sans-serif",localeChosen:null,view:"chart",startDisplayedDate:null,line:e,rect:null,width:1e3,height:450,margin:{top:60,bottom:40,left:20,right:110},content:null,dates:null,minYValue:null,maxYValue:null,extentX:null,svg:null,x:null,y:null,xAxis:null,lineFollowX:null,mouseMoveX:null,selectedData:{},dragStart:null,dateHovered:null,dateMinDisplayed:null,dateMaxDisplayed:null,limitNbOfHours:24,data:[],filteredData:[],lastIntersectIndex:0,index:0,predictionLine:null,intersectionPoints:[],allIntersectIndices:[0],colorBoxes:[]}},computed:{unitString:function(){return o[this.$store.state.units][this.$i18n.locale]}},methods:{splitDateTime:function(t){let e=t.eventDate.split("T"),a=e[0].split("-"),i=e[1].slice(0,-1).split(":");return a+i},clearContent:function(){let t=this;this.content=document.getElementById("waterLevelChart");var e=t.content.lastElementChild;while(e)t.content.removeChild(e),e=t.content.lastElementChild},initializeChart:function(){let t=this;null!=this.localeChosen&&V["k"](this.localeChosen),this.data=[],this.data=[...this.dataToDisplay["waterData"]["wlp"]],this.data.sort((function(e,a){var i=t.splitDateTime(e),s=t.splitDateTime(a);return i>s?1:i<s?-1:0}));for(let r=0;r<this.data.length;r++)this.data[r].date=new Date(this.data[r].eventDate);this.dates=this.data.map(t=>t.date),this.maxYValue=null,this.minYValue=null;var e=V["f"](this.data,t=>t.value);(null===this.minYValue||e<this.minYValue)&&(this.minYValue=e);var a=V["e"](this.data,t=>t.value);(null===this.maxYValue||a>this.maxYValue)&&(this.maxYValue=a),this.extentX=V["c"](this.data,t=>t.date),this.dateMinDisplayed=new Date(this.extentX[0]),this.dateMaxDisplayed=new Date,this.dateMaxDisplayed.setHours(this.dateMinDisplayed.getHours()+this.limitNbOfHours),this.x=V["i"](),this.setXDomain(),this.x.range([this.margin.left,this.width-this.margin.right]),this.y=V["h"]().domain([this.minYValue,this.maxYValue]).range([this.height-this.margin.bottom,this.margin.top]),this.svg=V["j"](this.content).append("svg").attr("class","svg-content-responsive").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 1000 500");let i=this.svg.append("defs");var s=i.append("linearGradient").attr("id","svgGradientAboveThreshold").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%");s.append("stop").attr("class","start").attr("offset","0%").attr("stop-color","#002b45").attr("stop-opacity",1),s.append("stop").attr("class","end").attr("offset","100%").attr("stop-color","#00416a").attr("stop-opacity",1);var n=i.append("linearGradient").attr("id","svgGradientBelowThreshold").attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","100%");n.append("stop").attr("class","start").attr("offset","0%").attr("stop-color","#842818").attr("stop-opacity",1),n.append("stop").attr("class","end").attr("offset","100%").attr("stop-color","#ce3d26").attr("stop-opacity",1)},addPredictionLine(){this.svg.append("g"),this.predictionLine=this.svg.append("path").data([this.data]).attr("class","line upfrontItem").attr("d",this.line).style("stroke-width",0).style("fill","none"),this.svg.append("path").data([this.filteredData]).attr("class","line upfrontItem").attr("d",this.line).style("stroke-width",4).style("stroke","white").style("fill","none")},computeColorBoxesAndIntersections(){this.intersectionPoints=[],this.colorBoxes=[],this.allIntersectIndices=[0];var t=this.y(this.dataToDisplay.waterLevel),e=this.predictionLine.node(),a=e.getTotalLength();this.lastIntersectIndex=0;for(var i=0;i<a;i++){var s=e.getPointAtLength(i);if(Math.floor(s.y)===Math.floor(t)&&(this.findIndexRelated(s.x),!this.allIntersectIndices.includes(this.index)&&this.index-this.allIntersectIndices[this.allIntersectIndices.length-1]>1)){this.allIntersectIndices.push(this.index);let t=e.getPointAtLength(i-1).y-s.y,a=null;a=t<0?"maxToMin":"minToMax",this.intersectionPoints.length>0&&this.index-this.intersectionPoints[this.intersectionPoints.length-1].index<11?this.intersectionPoints.pop():this.intersectionPoints.push({index:this.index,x:this.dates[this.index],y:s.y,intersectType:a});let n=this.lastIntersectIndex,r=this.index;this.constructColorBox(n,r),this.lastIntersectIndex=this.index}}let n=this.lastIntersectIndex,r=this.dates.length-1;this.constructColorBox(n,r)},constructColorBox(t,e){const a=t=>t.reduce((t,e)=>t+e)/t.length;let i=this.data.slice(t,e+1);i.splice(0,0,{date:this.data[t]["date"],value:this.dataToDisplay.waterLevel}),i.push({date:this.data[e]["date"],value:this.dataToDisplay.waterLevel});let s=null,n=null;0!=i.length&&(a(i.map(t=>t.value))>this.dataToDisplay.waterLevel?(s="url(#svgGradientAboveThreshold)",n="good"):(s="url(#svgGradientBelowThreshold)",n="bad"),this.colorBoxes.push({type:n,startIndex:t,endIndex:e,startDate:this.dates[t],endDate:this.dates[e],color:s,values:i})),this.$emit("colorBoxChanged",this.colorBoxes)},fillChart:function(){let t=this;this.svg.append("line").attr("x1",this.margin.left).attr("y1",this.y(this.dataToDisplay.waterLevel)).attr("x2",this.width-this.margin.right+20).attr("y2",this.y(this.dataToDisplay.waterLevel)).attr("class","line upfrontItem").style("stroke","#58d9fd").style("stroke-width",6),this.svg.append("line").attr("x1",this.width-this.margin.right+24).attr("y1",this.y(this.dataToDisplay.waterLevel)).attr("x2",this.width-this.margin.right+30).attr("y2",this.y(this.dataToDisplay.waterLevel)).attr("class","line upfrontItem").style("stroke","#58d9fd").style("stroke-width",6),this.svg.append("line").attr("x1",this.width-this.margin.right+34).attr("y1",this.y(this.dataToDisplay.waterLevel)).attr("x2",this.width-this.margin.right+40).attr("y2",this.y(this.dataToDisplay.waterLevel)).attr("class","line upfrontItem").style("stroke","#58d9fd").style("stroke-width",6),this.svg.append("line").attr("x1",this.width-this.margin.right+44).attr("y1",this.y(this.dataToDisplay.waterLevel)).attr("x2",this.width-this.margin.right+50).attr("y2",this.y(this.dataToDisplay.waterLevel)).attr("class","line upfrontItem").style("stroke","#58d9fd").style("stroke-width",6),this.svg.append("text").style("opacity",1).style("fill","#58d9fd").style("font-size","22px").style("font-weight","bold").style("font-family",this.fontFamily).attr("class","levelValuesOnChart upfrontItem").attr("x",this.width-this.margin.right+60).attr("y",this.y(this.dataToDisplay.waterLevel)+6).text(Math.round(10*this.dataToDisplay.waterLevel)/10+this.unitString);let e=this.dataToDisplay["waterData"]["wlphilo"].filter((function(e){return new Date(e.eventDate)>=t.dateMinDisplayed&&new Date(e.eventDate)<=t.dateMaxDisplayed}));for(let i=0;i<e.length;i++){let a=null;if(0===i){let t=e[i+1]["value"]-e[i]["value"];a=t>0?"low":"high"}else{let t=e[i-1]["value"]-e[i]["value"];a=t>0?"low":"high"}let s=new Date(e[i]["eventDate"]);this.svg.append("circle").attr("class","circle").attr("cx",this.x(s)).attr("cy",this.y(e[i]["value"])).attr("r",10).style("fill","white");let n=s.getHours().toString(),r=s.getMinutes().toString();r=("0"+r).slice(-2),this.svg.append("text").style("opacity",1).style("fill","white").style("font-family",this.fontFamily).style("font-size","22px").attr("class","levelValuesOnChart upfrontItem").attr("x",this.x(s)).attr("y",(function(){return"high"===a?t.y(e[i]["value"])-35:t.y(e[i]["value"])+29})).attr("text-anchor","middle").text(n+":"+r),this.svg.append("text").style("opacity",1).style("fill","white").style("font-size","20px").style("font-family",this.fontFamily).attr("class","levelValuesOnChart upfrontItem").attr("x",this.x(s)).attr("y",(function(){return"high"===a?t.y(e[i]["value"])-15:t.y(e[i]["value"])+50})).attr("text-anchor","middle").text(Math.round(10*e[i]["value"])/10+this.unitString)}for(let i of this.intersectionPoints.filter((function(e){return e.x>=t.dateMinDisplayed&&e.x<=t.dateMaxDisplayed}))){this.svg.append("circle").attr("class","circle").attr("cx",t.x(i.x)).attr("cy",i.y).attr("r",7).style("fill","#b1cfca");let e=i.x.getHours().toString(),a=i.x.getMinutes().toString();a=("0"+a).slice(-2),this.svg.append("text").style("opacity",1).style("fill","#b1cfca").style("font-size","23px").style("font-family",this.fontFamily).attr("class","levelValuesOnChart upfrontItem").attr("x",(function(){return"minToMax"===i.intersectType?t.x(i.x)+15:t.x(i.x)+4})).attr("y",i.y-5).attr("text-anchor","right").text(e+":"+a)}let a=[];for(let i=0;i<this.colorBoxes.length;i++)if(this.dateMinDisplayed>=this.colorBoxes[i].startDate&&this.dateMaxDisplayed<=this.colorBoxes[i].endDate){a.push({color:this.colorBoxes[i].color,values:[]});let e=this.colorBoxes[i].values.filter((function(e){return e.date>=t.dateMinDisplayed&&e.date<=t.dateMaxDisplayed})),s=[{date:this.dateMinDisplayed,value:this.dataToDisplay.waterLevel}].concat(e);s.push({date:this.dateMaxDisplayed,value:this.dataToDisplay.waterLevel}),a.push({color:this.colorBoxes[i].color,values:s})}else if(this.dateMinDisplayed>=this.colorBoxes[i].startDate&&this.dateMinDisplayed<=this.colorBoxes[i].endDate){a.push({color:this.colorBoxes[i].color,values:[]});let e=this.colorBoxes[i].values.filter((function(e){return e.date>=t.dateMinDisplayed&&e.date<=t.dateMaxDisplayed})),s=[{date:this.dateMinDisplayed,value:this.dataToDisplay.waterLevel}].concat(e);a.push({color:this.colorBoxes[i].color,values:s})}else if(this.dateMinDisplayed<=this.colorBoxes[i].startDate&&this.dateMaxDisplayed>=this.colorBoxes[i].endDate)a.push({color:this.colorBoxes[i].color,values:this.colorBoxes[i].values});else if(this.dateMaxDisplayed>=this.colorBoxes[i].startDate&&this.dateMaxDisplayed<=this.colorBoxes[i].endDate){let e=this.colorBoxes[i].values.filter((function(e){return e.date>=t.dateMinDisplayed&&e.date<=t.dateMaxDisplayed}));e.push({date:this.dateMaxDisplayed,value:this.dataToDisplay.waterLevel}),a.push({color:this.colorBoxes[i].color,values:e})}for(let i=0;i<a.length;i++)this.svg.append("path").data([a[i].values]).attr("class","line").attr("d",this.line).style("stroke-width",4).style("stroke",a[i].color).style("fill",a[i].color)},findIndexRelated:function(t){var e=this.x.invert(t);this.index=V["a"](this.dates,e)},findDataRelated(t,e){var a=V["g"](t,e);this.findIndexRelated(a[0]),this.selectedData=this.data[this.index]},addInteractions:function(){this.rect=this.svg.append("rect").style("fill","none").style("pointer-events","all").attr("class","chartRect"),this.rect.call(V["b"]().on("start",this.dragStarted).on("drag",this.dragged).on("end",this.dragEnded))},dragStarted:function(){"mousedown"===event.type&&this.findDataRelated(event,this.rect),"touchstart"===event.type&&this.findDataRelated(event.touches[0],event.target),this.dragStart=this.selectedData},dragged:function(){"mousemove"===event.type&&this.findDataRelated(event,this.rect),"touchmove"===event.type&&this.findDataRelated(event.touches[0],event.target);var t=this.dragStart.date.getTime()-this.selectedData.date.getTime();this.dateMinDisplayed.setTime(this.dateMinDisplayed.getTime()+t),this.dateMaxDisplayed.setTime(this.dateMaxDisplayed.getTime()+t),this.$emit("draggedDate",this.dateMinDisplayed),this.resetChart()},resetChart:function(){this.setXDomain(),this.svg.selectAll(".line").remove(),this.svg.selectAll(".rect").remove(),this.svg.selectAll(".circle").remove(),this.svg.selectAll(".levelValuesOnChart").remove(),this.addPredictionLine(),this.fillChart(),this.svg.selectAll(".upfrontItem").raise(),this.svg.selectAll(".circle").raise(),this.svg.selectAll(".chartRect").raise()},setXDomain:function(){var t;this.dateMinDisplayed<=this.extentX[0]?(t=new Date(this.extentX[0]),this.dateMinDisplayed=new Date(this.extentX[0]),this.dateMaxDisplayed=new Date(t.setHours(t.getHours()+this.limitNbOfHours)),this.filterData(),this.x.domain([this.dateMinDisplayed,this.dateMaxDisplayed])):this.dateMinDisplayed>this.extentX[0]&&this.dateMaxDisplayed<this.extentX[1]?(this.filterData(),this.x.domain([this.dateMinDisplayed,this.dateMaxDisplayed])):this.dateMaxDisplayed>=this.extentX[1]&&(t=new Date(this.extentX[1]),this.dateMaxDisplayed=new Date(this.extentX[1]),this.dateMinDisplayed=new Date(t.setHours(t.getHours()-this.limitNbOfHours)),this.filterData(),this.x.domain([this.dateMinDisplayed,this.dateMaxDisplayed]))},filterData(){let t=this;this.filteredData=this.data.filter((function(e){return e.date>=t.dateMinDisplayed&&e.date<=t.dateMaxDisplayed}))},updateChart:function(){this.clearContent(),0!==this.dataToDisplay.waterData["wlp"].length&&(this.initializeChart(),null!==this.svg&&(this.addPredictionLine(),this.computeColorBoxesAndIntersections(),this.fillChart(),this.svg.selectAll(".upfrontItem").raise(),this.svg.selectAll(".circle").raise(),this.svg.selectAll(".chartRect").raise(),this.addInteractions()))},changeStartDate:function(){let t=this,e=this.startDisplayedDate.getTime()-this.dateMinDisplayed.getTime(),a=20;Math.abs(e)>25e7&&(a=50);let i=0;function s(){n(),i++,i<a&&setTimeout(s,15)}function n(){t.dateMinDisplayed.setTime(t.dateMinDisplayed.getTime()+e/a),t.dateMaxDisplayed.setTime(t.dateMaxDisplayed.getTime()+e/a),t.resetChart()}s()}},mounted(){this.bus.$on("dateClicked",t=>{this.startDisplayedDate=t,this.changeStartDate()})},watch:{"dataToDisplay.waterData.wlphilo":function(){this.updateChart()},"dataToDisplay.waterLevel":function(){this.updateChart()},"$i18n.locale":function(){"fr"===this.$i18n.locale?this.localeChosen=p:this.localeChosen=u,this.updateChart()}}}),j=N,U=(a("9b17"),Object(D["a"])(j,P,R,!1,null,null,null)),H=U.exports,W={components:{TheCalendarView:O,TheChart:H},props:["dataToDisplay","range"],data(){return{view:"chart",colorBoxes:[],daysArray:[],startDisplayedDate:null,activeIndex:1,bus:new i["default"],isBackHovered:!1,isNextHovered:!1}},computed:{isBackGreyed:function(){return 1===this.activeIndex},isNextGreyed:function(){return this.activeIndex===this.daysArray.length}},methods:{dayPlusOne:function(){this.activeIndex+=1,this.bus.$emit("dateClicked",this.daysArray[this.activeIndex-1])},dayMinusOne:function(){this.activeIndex-=1,this.bus.$emit("dateClicked",this.daysArray[this.activeIndex-1])},mouseOverBack:function(){this.isBackHovered=!0},mouseLeaveBack:function(){this.isBackHovered=!1},mouseOverNext:function(){this.isNextHovered=!0},mouseLeaveNext:function(){this.isNextHovered=!1},getDay:function(t){return c[this.$i18n.locale][t.getDay()]},getDate:function(t){let e=h[this.$i18n.locale][t.getMonth()],a=t.getDate();return a+" "+e},loadColorBoxes:function(t){this.colorBoxes=t},updateDots:function(){this.activeIndex=1;let t=function(t,e){let a=[];for(let i=new Date(t);i<e;i.setDate(i.getDate()+1))a.push(new Date(i));return a};this.daysArray=t(this.range[0],this.range[1])},logClick:function(t){this.bus.$emit("dateClicked",this.daysArray[t-1]),this.activeIndex=t},setActiveDot:function(t){let e=this,a=function(){let a={date:null,diff:null};for(let i=0;i<e.daysArray.length;i++)(null===a.date||Math.abs(e.daysArray[i]-t)<a.diff)&&(a={date:e.daysArray[i],diff:Math.abs(e.daysArray[i]-t)});return a},i=a();for(let s=0;s<this.daysArray.length;s++)this.daysArray[s]===i.date&&(this.activeIndex=s+1)}},watch:{range:function(t,e){0!==e.length&&(t[0].getTime()===e[0].getTime()&&t[1].getTime()===e[1].getTime()||this.updateDots())}}},F=W,Y=(a("6613"),Object(D["a"])(F,L,_,!1,null,null,null)),J=Y.exports,X=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"language-button",on:{click:function(e){return t.switchLocale()}}},[i("img",{staticClass:"logo",attrs:{src:a("f211")}}),i("span",{staticClass:"switchText"},[t._v(t._s("fr"===t.$i18n.locale?"EN":"FR")+" ")])])},E=[],q={methods:{switchLocale(){"fr"===this.$i18n.locale?this.$i18n.locale="en":this.$i18n.locale="fr"}}},z=q,G=(a("f30c"),Object(D["a"])(z,X,E,!1,null,null,null)),Z=G.exports,Q=a("bc3a"),K=a.n(Q),tt={name:"App",components:{TheControlPane:k,TheChartAndOptions:J,TheLanguageButton:Z},data(){return{range:[],draught:null,destination:null,specificWaterLevel:null,waterLevelData:{},limitWaterLevel:0,dataToDisplay:{},type:0,changedRange:!0}},methods:{date2string(t,e,a,i,s){return t+"-"+e+"-"+a+"T"+i+":"+s+":00Z"},getDateValuesFromDate(t){var e=String(t.getUTCFullYear()),a=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),s=String(t.getUTCHours()).padStart(2,"0"),n=String(t.getUTCMinutes()).padStart(2,"0");return this.date2string(e,a,i,s,n)},apiCall:async function(){let t=[["wlp","wlp"],["wlp-hilo","wlphilo"]],e=this;for(let a of t){const t=await K.a.get("https://api.iwls.azure.cloud.dfo-mpo.gc.ca/api/v1/stations/5cebf1de3d0f4a073c4bbaf1/data?time-series-code="+a[0]+"&from="+e.getDateValuesFromDate(e.range[0])+"&to="+e.getDateValuesFromDate(e.range[1]));200===t.status&&this.$set(this.waterLevelData,a[1],t.data)}},modifyData:function(t){this.range[0]===t.range.start&&this.range[1]===t.range.end?this.changedRange=!1:this.changedRange=!0,this.range=[t.range.start,t.range.end],this.draught=t.draught,this.destination=t.destination,this.specificWaterLevel=t.specificWaterLevel,this.checkType()},changeType:function(t){this.type=t,this.checkType()},checkType:function(){"visitor"===this.type?this.limitWaterLevel=this.draught+this.destination:this.limitWaterLevel=this.specificWaterLevel,this.downloadData()},downloadData:async function(){!0===this.changedRange&&(await this.apiCall(),"meter"!=this.$store.state.units&&this.changeDataUnits(this.$store.state.units)),this.$set(this.dataToDisplay,"waterLevel",this.limitWaterLevel),this.$set(this.dataToDisplay,"waterData",this.waterLevelData)},changeDataUnits:function(t){for(let e in this.waterLevelData)for(let a=0;a<this.waterLevelData[e].length;a++)this.waterLevelData[e][a].value=d[t](this.waterLevelData[e][a].value)}},watch:{"$store.state.units":function(t){this.changeDataUnits(t),this.$set(this.dataToDisplay,"waterLevel",this.limitWaterLevel),this.$set(this.dataToDisplay,"waterData",this.waterLevelData)}}},et=tt,at=(a("034f"),Object(D["a"])(et,s,n,!1,null,null,null)),it=at.exports,st=a("a925");function nt(){const t=a("49f8"),e={};return t.keys().forEach(a=>{const i=a.match(/([A-Za-z0-9-_]+)\./i);if(i&&i.length>1){const s=i[1];e[s]=t(a)}}),e}i["default"].use(st["a"]);var rt=new st["a"]({locale:"en",fallbackLocale:"en",messages:nt()}),lt=a("5887"),ot=a.n(lt),dt=a("5f5b");const ct=i["default"].observable({units:"meter"}),ht={updateSelectedUnits(t){ct.units=t}};var ut={state:ct,mutations:ht};a("f9e3"),a("2dd8");i["default"].config.productionTip=!1,i["default"].use(ot.a),i["default"].prototype.$store=ut,i["default"].use(dt["a"]),new i["default"]({i18n:rt,render:t=>t(it)}).$mount("#app")},"5d23":function(t,e,a){t.exports=a.p+"img/back-button-black-on-white.57077c14.svg"},"60dc":function(t,e,a){t.exports=a.p+"img/back-button-greyed.31055515.svg"},"623b":function(t,e,a){},6613:function(t,e,a){"use strict";a("9e88")},6882:function(t,e,a){t.exports=a.p+"img/next-button-white-on-black.875506ea.svg"},8542:function(t,e,a){},"85a8":function(t,e,a){t.exports=a.p+"img/back-button-white-on-black.5f194597.svg"},"85ec":function(t,e,a){},"9b17":function(t,e,a){"use strict";a("1c91")},"9e88":function(t,e,a){},ab43:function(t,e,a){t.exports=a.p+"img/next-button-black-on-white.9c654ad5.svg"},b5ec:function(t,e,a){"use strict";a("f6f8")},bc82:function(t,e,a){"use strict";a("623b")},edd4:function(t){t.exports=JSON.parse('{"draught":"Draught: ","submit":"Submit","chartYLabel":"Water Level","chart":"Chart","Calendrier":"Calendar","invalidRangeMessage":"The range selected cannot be more than 6 days. It has been corrected automatically","boat-choice":"Boat destination:","visitor-dock":"Visitor dock","unknown_waterlevel":"Unknown water level required","specific_waterlevel":"Specific water level","units":"Units","meters":"Meter","feet":"Foot","meter":"meter","foot":"foot","calendar-title":"To select another date or dates, please click on the calendar","calendar-usage-title":"How to use the calendar?","calendar-explanation":"With this calendar, you can either select one or several dates.\\nTo select only one date, please click twice on the same date.\\nTo select multiple dates, click on the starting date and then click on the ending date. Please note that it is not posible to select more than 6 days at a time. ","calendar":"Calendar","calendar-view-title":"Possible schedules for entering or leaving","app-title":"Water level prediction - Rivière-du-Loup yacht club","member":"Member","visitor":"Visitor","marina-layout":"View marina layout","specific-water-level":"Water level"}')},f18b:function(t,e,a){t.exports=a.p+"img/next-button-greyed.1f61c741.svg"},f211:function(t,e,a){t.exports=a.p+"img/language-light.dd65e165.svg"},f30c:function(t,e,a){"use strict";a("8542")},f693:function(t){t.exports=JSON.parse('{"draught":"Tirant d\'eau: ","submit":"Soumettre","chartYLabel":"Hauteur d\'eau","chart":"Graphique","Calendrier":"Calendrier","invalidRangeMessage":"La plage de date ne peut être supérieure à 6 jours. Elle a été modifiée automatiquement. ","boat-choice":"Emplacement de l\'embarcation:","visitor-dock":"Quai visiteur","unknown_waterlevel":"Niveau d\'eau requis inconnu","specific_waterlevel":"Niveau d\'eau spécifique","units":"Unités","meters":"Mètre","feet":"Pied","meter":"mètre","foot":"pied","calendar-title":"Pour sélectionner une autre date ou groupe de date, veuillez cliquer sur le calendrier","calendar-usage-title":"Comment utiliser le calendrier?","calendar-explanation":"Avec ce calendrier, vous pouvez sélectionner une ou plusieurs dates.\\nPous sélectionner une date, veuiller cliquer à deux reprises sur la même date.\\nPour sélectionner plus d\'une date, veuillez cliquer sur la date de départ puis sur la date de fin. \\nÀ noter qu\'il n\'est pas possible de sélectionner plus de 6 jours à la fois.","calendar":"Calendrier","calendar-view-title":"Horaires possibles pour l\'entrée ou sortie","app-title":"Prédiction des niveaux d\'eau - Marina de Rivière-du-Loup","app-description":"Cet outil permet de planifier vos sorties et entrées dans la marina de Rivière-du-Loup. \\nPour se faire, vous devez:\\nChoisir une ou plusieurs date en cliquand sur le calendrier.\\nIndiquer le tirant d\'eau de votre embarcation.\\nChoisir l\'endroit d\'arrivée ou de sortie. ","app-description-intro":"Cet outil permet de planifier vos sorties et entrées dans la marina de Rivière-du-Loup. \\nPour se faire, vous devez:","app-description-bullet-one":"Choisir une ou plusieurs date en cliquand sur le calendrier.","app-description-bullet-two":"Indiquer le tirant d\'eau de votre embarcation.","app-description-bullet-three":"Choisir l\'endroit d\'arrivée ou de sortie.","member":"Membre","visitor":"Visiteur","marina-layout":"Voir Marina","specific-water-level":"Niveau d\'eau"}')},f6f8:function(t,e,a){}});
//# sourceMappingURL=app.cbd2e41e.js.map